package io . netty . example . http2 . helloworld . server ; import io . netty . channel . ChannelHandlerContext ; import io . netty . handler . codec . http . HttpObjectAggregator ; import io . netty . handler . codec . http . HttpServerCodec ; import io . netty . handler . ssl . ApplicationProtocolNames ; import io . netty . handler . ssl . ApplicationProtocolNegotiationHandler ; public class Http2OrHttpHandler extends ApplicationProtocolNegotiationHandler { private static final int MAX_CONTENT_LENGTH = <int> * <int> ; protected Http2OrHttpHandler ( ) { super ( ApplicationProtocolNames . HTTP_1_1 ) ; } @Override protected void configurePipeline ( ChannelHandlerContext ctx , String protocol ) throws Exception { if ( ApplicationProtocolNames . HTTP_2 . equals ( protocol ) ) { ctx . pipeline ( ) . addLast ( new HelloWorldHttp2Handler . Builder ( ) . build ( ) ) ; return ; } if ( ApplicationProtocolNames . HTTP_1_1 . equals ( protocol ) ) { ctx . pipeline ( ) . addLast ( new HttpServerCodec ( ) , new HttpObjectAggregator ( MAX_CONTENT_LENGTH ) , new HelloWorldHttp1Handler ( <str> ) ) ; return ; } throw new IllegalStateException ( <str> + protocol ) ; } } 
