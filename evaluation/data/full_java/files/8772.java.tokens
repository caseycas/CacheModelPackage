package org . elasticsearch . script . javascript . support ; import org . mozilla . javascript . Scriptable ; import org . mozilla . javascript . Wrapper ; import java . util . Iterator ; import java . util . Map ; public class NativeMap implements Scriptable , Wrapper { private static final long serialVersionUID = <int> ; private Map < Object , Object > map ; private Scriptable parentScope ; private Scriptable prototype ; public static NativeMap wrap ( Scriptable scope , Map < Object , Object > map ) { return new NativeMap ( scope , map ) ; } private NativeMap ( Scriptable scope , Map < Object , Object > map ) { this . parentScope = scope ; this . map = map ; } public Object unwrap ( ) { return map ; } public String getClassName ( ) { return <str> ; } public Object get ( String name , Scriptable start ) { if ( <str> . equals ( name ) ) { return map . size ( ) ; } else { return map . get ( name ) ; } } public Object get ( int index , Scriptable start ) { Object value = null ; int i = <int> ; Iterator itrValues = map . values ( ) . iterator ( ) ; while ( i + + < = index & & itrValues . hasNext ( ) ) { value = itrValues . next ( ) ; } return value ; } public boolean has ( String name , Scriptable start ) { return map . containsKey ( name ) ; } public boolean has ( int index , Scriptable start ) { return ( index > = <int> & & map . values ( ) . size ( ) > index ) ; } @SuppressWarnings ( <str> ) public void put ( String name , Scriptable start , Object value ) { map . put ( name , value ) ; } public void put ( int index , Scriptable start , Object value ) { } public void delete ( String name ) { map . remove ( name ) ; } public void delete ( int index ) { int i = <int> ; Iterator itrKeys = map . keySet ( ) . iterator ( ) ; while ( i < = index & & itrKeys . hasNext ( ) ) { Object key = itrKeys . next ( ) ; if ( i = = index ) { map . remove ( key ) ; break ; } } } public Scriptable getPrototype ( ) { return this . prototype ; } public void setPrototype ( Scriptable prototype ) { this . prototype = prototype ; } public Scriptable getParentScope ( ) { return this . parentScope ; } public void setParentScope ( Scriptable parent ) { this . parentScope = parent ; } public Object [ ] getIds ( ) { return map . keySet ( ) . toArray ( ) ; } public Object getDefaultValue ( Class hint ) { return null ; } public boolean hasInstance ( Scriptable value ) { if ( ! ( value instanceof Wrapper ) ) return false ; Object instance = ( ( Wrapper ) value ) . unwrap ( ) ; return Map . class . isInstance ( instance ) ; } } 
