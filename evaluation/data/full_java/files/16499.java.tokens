package org . junit . validator ; import java . util . concurrent . ConcurrentHashMap ; public class AnnotationValidatorFactory { private static final ConcurrentHashMap < ValidateWith , AnnotationValidator > VALIDATORS_FOR_ANNOTATION_TYPES = new ConcurrentHashMap < ValidateWith , AnnotationValidator > ( ) ; public AnnotationValidator createAnnotationValidator ( ValidateWith validateWithAnnotation ) { AnnotationValidator validator = VALIDATORS_FOR_ANNOTATION_TYPES . get ( validateWithAnnotation ) ; if ( validator ! = null ) { return validator ; } Class < ? extends AnnotationValidator > clazz = validateWithAnnotation . value ( ) ; try { AnnotationValidator annotationValidator = clazz . newInstance ( ) ; VALIDATORS_FOR_ANNOTATION_TYPES . putIfAbsent ( validateWithAnnotation , annotationValidator ) ; return VALIDATORS_FOR_ANNOTATION_TYPES . get ( validateWithAnnotation ) ; } catch ( Exception e ) { throw new RuntimeException ( <str> + clazz . getName ( ) , e ) ; } } } 
