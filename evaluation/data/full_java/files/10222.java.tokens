package com . google . common . math ; import static com . google . common . math . MathBenchmarking . ARRAY_MASK ; import static com . google . common . math . MathBenchmarking . ARRAY_SIZE ; import static com . google . common . math . MathBenchmarking . RANDOM_SOURCE ; import static com . google . common . math . MathBenchmarking . randomNonZeroBigInteger ; import static com . google . common . math . MathBenchmarking . randomPositiveBigInteger ; import com . google . caliper . BeforeExperiment ; import com . google . caliper . Benchmark ; import com . google . caliper . Param ; import com . google . common . math . LongMath ; import java . math . RoundingMode ; public class LongMathRoundingBenchmark { @Param ( { <str> , <str> , <str> , <str> , <str> , <str> , <str> } ) RoundingMode mode ; private static final long [ ] positive = new long [ ARRAY_SIZE ] ; private static final long [ ] nonzero = new long [ ARRAY_SIZE ] ; private static final long [ ] longs = new long [ ARRAY_SIZE ] ; @BeforeExperiment void setUp ( ) { for ( int i = <int> ; i < ARRAY_SIZE ; i + + ) { positive [ i ] = randomPositiveBigInteger ( Long . SIZE - <int> ) . longValue ( ) ; nonzero [ i ] = randomNonZeroBigInteger ( Long . SIZE - <int> ) . longValue ( ) ; longs [ i ] = RANDOM_SOURCE . nextLong ( ) ; } } @Benchmark int log2 ( int reps ) { int tmp = <int> ; for ( int i = <int> ; i < reps ; i + + ) { int j = i & ARRAY_MASK ; tmp + = LongMath . log2 ( positive [ j ] , mode ) ; } return tmp ; } @Benchmark int log10 ( int reps ) { int tmp = <int> ; for ( int i = <int> ; i < reps ; i + + ) { int j = i & ARRAY_MASK ; tmp + = LongMath . log10 ( positive [ j ] , mode ) ; } return tmp ; } @Benchmark int sqrt ( int reps ) { int tmp = <int> ; for ( int i = <int> ; i < reps ; i + + ) { int j = i & ARRAY_MASK ; tmp + = LongMath . sqrt ( positive [ j ] , mode ) ; } return tmp ; } @Benchmark int divide ( int reps ) { int tmp = <int> ; for ( int i = <int> ; i < reps ; i + + ) { int j = i & ARRAY_MASK ; tmp + = LongMath . divide ( longs [ j ] , nonzero [ j ] , mode ) ; } return tmp ; } } 
